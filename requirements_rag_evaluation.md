# RAG評価システム 要件定義・設計方針（2025/07/08）

## 1. 概要
- RAG（Retrieval-Augmented Generation）戦略・モデルの多角的な比較評価を行う研究用Webアプリ。
- チャンク手法やパラメータ、LLMモデルの組み合わせごとに自動・手動で一括評価し、グラフ・表・レポートとして可視化・エクスポートできる。
- モデル追加・戦略追加も容易に拡張可能な設計。
- docker-composeで環境構築可能。

---

## 2. 評価モード
### 2.1 単体評価モード
- 既存通り、1つのモデル・戦略を個別評価し、指標グラフ・表を表示

### 2.2 一括評価モード
- 複数モデル×複数戦略の全組み合わせ、またはユーザー選択組み合わせで一括評価
- 結果を総合比較ダッシュボード（棒グラフ・バブルチャート・レーダーチャート・表）で表示
- UIで「全パターン自動」「都度選択」切り替え可

---

## 3. 比較・可視化
- 総合スコアランキング（棒グラフ）
- チャンク分布 vs パフォーマンス（バブルチャート）
- 各種メトリクス比較（レーダーチャート）
- 全結果を表形式で横断比較
- グラフ・表は日本語ラベル対応

---

## 4. エクスポート機能
- CSVダウンロード（比較表データ）
- PDFレポート出力（グラフ・表・サマリー付き、A4横推奨）
- PDFにはタイトル・実験条件・グラフ・表・考察欄を含む

---

## 5. モデル・戦略の管理・拡張性
- モデルリスト・戦略リストは**設定ファイル（例：models.yaml, strategies.yaml）**や**DB/API**から動的取得
- UI・バックエンドとも「モデル追加・戦略追加時にコード修正不要」な設計とする
- 例：models.yaml
```yaml
models:
  - name: mistral
    type: ollama
    display_name: "Mistral (Ollama)"
  - name: gpt-4o-mini
    type: openai
    display_name: "GPT-4o-mini (OpenAI)"
  # ...追加もここに追記するだけ
```
- バックエンドでこの設定ファイルを読み込み、`/list_models` API等でフロントエンドへ提供
- フロントエンドはAPI経由でモデル・戦略リストを取得し、UIに自動反映

---

## 6. 推奨UI/UX
- サイドバーやタブで評価モード切替
- 一括評価時はモデル・戦略を複数選択、または「全自動」ボタン
- 比較ダッシュボードにグラフ・表・ダウンロードボタン
- モデル・戦略追加時は設定ファイル/API/DBに追記するだけでOK

---

## 7. サンプルPDFレポート構成
- タイトル：RAG戦略・モデル比較レポート
- サマリー：日付・対象モデル/戦略リスト・実験条件
- 総合ランキング（棒グラフ）
- チャンク分布vsスコア（バブルチャート）
- メトリクス比較（レーダーチャート）
- 比較表（DataFrame）
- 考察欄（空欄）

---

## 8. 今後の拡張性
- モデル・戦略の追加・削除が容易
- 評価指標の追加やカスタム指標にも対応可能な設計
- 複数ユーザー/実験条件の保存・切替も将来的に拡張可

---

## 9. 備考・運用メモ
- モデルリスト・戦略リストの取得元は現状ハードコード→設定ファイル/API化推奨
- 研究用途のため、比較・再現性・エクスポート性を最重視
- 詳細設計・実装はこの要件に準拠
